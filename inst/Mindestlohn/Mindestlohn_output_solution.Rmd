
---
title: Problem Set Mindestlohn
always_allow_html: true
output: 
  html_document: 
    keep_md: yes
    toc: yes
---

```{r setup, include=FALSE, echo=FALSE}
# Load libraries and source extra code
library(ggplot2)
library(haven)
library(RTutor)


# Options for rendering data frames
# If you knit to a Word docx file, try
# 
# data.frame.theme="word" 
# 
# (needs RStudio > 1.2.1)
# 
# You can also set the options like
# table.max.cols as chunk options
# Makes sense if there are too many, too wide
# columns in some chunks

RTutor::set.knit.print.opts(data.frame.theme="code", table.max.rows=25, table.max.cols=NULL, round.digits=5, signif.digits=8)


# continue knitting even if there is an error
knitr::opts_chunk$set(error = TRUE) 
```

## Mindestlohn und Firmenprofitabilität: Eine interaktive Analyse

- Einführung .



## Exercise Inhaltsübersicht

1. Einführung in den Mindestlohn

2. Datenüberblick

3. Difference in Differences

4. Einordnung des Artikels


## Exercise 1 -- Einführung in den Mindestlohn

- Hintergrund der Mindestlohneinführung
- sic
- Vergleich zu anderen Staaten


Quiz: Auf welche Höhe schätzen Sie den gesetzlichen Mindestlohn in Großbrittanien zur Einführung 1999 (in Pfund)?

- 3.6 [x]

- 5.7 [ ]

- 7.8 [ ]




Quiz: Wie werden Lohnerhöhungen hauptsächlich gedeckt?

- Verkleinerung der Gewinnmarge [x]

- Weitergabe an Verbraucher [ ]

- Effizienzsteigerung [ ]


## Exercise 2 -- Datenüberblick

## Exercise ? -- Schaubilder

Es soll überprüft werden, wie sich die Einführung des Mindestlohns auf die unterschiedlichen Einkommen ausgewirkt hat. 
Um die Veränderung des Lohns zum Vorjahr zu messen, muss der Datensatz zunächst für jedes einzelne Jahr aufgeteilt werden.

Zu Beginn wird der Datensatz eingelesen.

```{r "4_1"}
dat_main = read_dta('main_fame.dta')
```
Nun wird für jedes Jahr ein eigener Datensatz erstellt. Dafür muss der Datensatz gefiltert werden.

```{r "4_2"}
# pcw95 = dat_main %>%
#   filter(___ == 1995)

#
pcw95 = dat_main %>%
  filter(year == 1995)
```



## Exercise 3 -- Difference in Differences

Bei der Difference in Difference (DiD) Methode werden die Daten anhand von zwei Kriterien unterteilt.
Zum einen wird entschieden, ob es sich um eine Pre-Treatment oder eine Post-Treatment Gruppe handelt.


Quiz: Ab welchem Zeitpunkt werden Daten der Post-Treatment Gruppe zugewiesen?

- 1999 [ ]

- 2000 [x]


Für eine DiD-Schätuung muss weiter eine Kontroll- und eine Treatmentgruppe definiert werden. In der Treatmentgruppe werden jene Unternehmen zusammengefasst, bei denen der Durchschnittslohn (avwage) im Jahr unter 12000 Pfund lag.
Die Kontrollgruppe umfasst Unternehmensdaten mit einem Durchschnittslohn zwischen 12000 und 20000 Pfund.

Mit einem Blick auf den Datensatz erkennt man, dass hierfür bereits Dummy-Variablen ertellt worden sind.
ctreat bezieht sich auf die Kontrollkomponente, während "NMW" angibt, ob sich die Daten der Pre- oder Post-Treatment Periode angehören.

```{r "5_3"}
dat_table_DiD = dat_main %>%
  group_by(ctreat1, NMW)%>%
  filter(pp == 1) %>%
  summarise(mean_avwage = mean(avwage), mean_ln_avwage = mean(ln_avwage), mean_net_pcm = mean(net_pcm))
```

Nachdem die relevanten Daten des DiD zusammengefasst in der Tabelle "dat_table_DiD" vorhanden sind, können die Differenzen nun händisch berechnet werden.

Die Formel hierfür lautet 
(y.post.treat - y.post.control) - (y.pre.treat - y.pre.control)

```{r "5_4"}
# # Weisen Sie den für die DiD Schätzung relevanten Variablen die passenden Tabelleneinträge aus "dat_table_DiD" zu.
# y1.post.treat = dat_table_DiD$mean_ln_avwage[___]
# y1.post.control = dat_table_DiD$mean_ln_avwage[___]
# y1.pre.treat = dat_table_DiD$mean_ln_avwage[___]
# y1.pre.control = dat_table_DiD$mean_ln_avwage[___]
# 

```


Quiz: Wieso werden für den Durchschnittslohn logarithmierte Werte verwendet?

- a [x]

- b [ ]

- c [ ]


Neben des logarithmierten Durchschnittslohns wird auch der DiD-Schätzer der Nettorendite eines Unternehmens je Geschäftsjahr (net_pcm) berechnet.
Das geschieht analog zur obigen Schätzung.

```{r "5_5"}
# y2.post.treat = dat_table_DiD$mean_net_pcm[___]
# y2.post.control = dat_table_DiD$mean_net_pcm[___]
# y2.pre.treat = dat_table_DiD$mean_net_pcm[___]
# y2.pre.control = dat_table_DiD$mean_net_pcm[___]

```

Dadurch erhalten wir folgende 


## Exercise 4 -- Einordnung des Artikels (weiterführende Überlegungen)

- EU-weiter Mindestlohn (Möglichkeiten, Chancen, Probleme)
- weitere Artikel


## Exercise Probleme beim Code

- i. Dummyvariablen in Stata
- Intervallregression


## Exercise Aufgabentypen 

a) We often want to compute some summary statistic of a vector. For example:

```{r "8_a_6"}
x = 10:23
# Computing the sum of x
sum(x)
```

Now compute the mean of x.
```{r "8_a_7",optional=TRUE}
# Note the chunk option optional = TRUE means
# the user can continue with the next exercise
# without having solved this one

mean(x)
```



***

### Info: useful functions for numeric vectors
Here are examples for useful R functions
```{r "8_a_8"}
max(c(1,5,2)) # returns maximum
min(c(1,5,2)) # returns minimum

sum(c(1,5,2,NA), na.rm=TRUE) # returns sum of all numbers, ignore NA
cumsum(c(1,5,2)) # returns cummulated sum
diff(c(1,5,2)) # returns the vector of differences
```

***




***

### Award: mean means mean
Well, in some occasions one can just guess the name of an R function. The function to compute the mean of a vector, or matrix is called 'mean'. Usually, it is much quicker to goggle than to guess function names, however.

***


b) Let `y` be a vector that contains the squared elements of `x`, i.e. for each element $i$ we want $$y_i = x_i^2.$$ Then show `y`.
```{r "8_b_9"}
# We should not set this chunk optional
# since we need y in the next chunk
y = x^2
y
```

c) Now use the function `qplot` from the package `ggplot2` to create a scatter plot of `x` against `y`. You can google `r qplot` to get the help for the function `qplot`.

```{r "8_c_10",optional=TRUE, dev='svg', fig.width=4}
library(ggplot2) # load ggplot2 package

# Enter your call to qplot here...
qplot(x,y)
# The block above allows the user to add extra arguments to the call to qplot, i.e. qplot(x,y,xlab="The variable x"), would also pass the test.
```



Quiz: What is the 'oddest' prime?

- 2 [x]

- 3 [ ]

- 5 [ ]

- 7 [ ]


Note: A quiz as specified below only works in the shiny environment. If you want to design a quiz in an RMarkdown based RTutor problem set, you should use a chunk. E.g. as follows:

Which of the following numbers is the oddest prime? 2,3,5 or 7? Enter you solution in the code below and press "check".

```{r "8_c_11"}
2
```

***

### Award: The oddest prime
Wouldn't you agree that the only even prime is the odd man out?

***


## Exercise Submitting your solution

To submit your solution please proceed as follows:

1. Scroll to the top and click on the icon with the bars <i class="fa fa-tasks fa-fw"></i> to see how many points you got so far. If you want to have more points you can try to solve the missing tasks.

2. If you want to submit click on the download button <i class="fa  fa-download fa-fw"></i> at the very right.

3. In the opened tab click the button "Download Submission File". Your browser should then download a file with the extension `.sub`.

4. Upload that downloaded file to your course management system like Moodle, as specified by your instructor.



